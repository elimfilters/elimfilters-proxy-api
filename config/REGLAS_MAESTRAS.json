{
  "version": "2.1.0",
  "timestamp": "2025-10-23T22:00:00Z",
  "description": "Reglas maestras con OEM Universe Completo v2.1.0",
  
  "oem_universe": {
    "patterns": {
      "donaldson": {
        "primary": [
          "/^P\\d{5,6}$/i",
          "/^DBL/i",
          "/^P[0-9]{4,7}$/i"
        ],
        "fallback": ["/^P[0-9]+$/i"],
        "brand": "DONALDSON",
        "priority": 1,
        "duty": "HD",
        "examples": ["P552100", "P164378", "DBL123"]
      },
      
      "fram": {
        "primary": [
          "/^(PH|CA|CF|CH)\\d{3,6}$/i",
          "/^PH[0-9]{1,5}$/i",
          "/^CA[0-9]{3,6}$/i",
          "/^CF[0-9]{3,6}$/i",
          "/^CH[0-9]{3,6}$/i"
        ],
        "fallback": [],
        "brand": "FRAM",
        "priority": 2,
        "duty": "LD",
        "examples": ["PH8A", "CA123", "CF456", "CH789"]
      },
      
      "generic": {
        "patterns": ["/^[A-Z0-9]{3,10}$/i"],
        "priority": 3,
        "duty": "any",
        "examples": ["LF3620", "1R1808", "FF5052"]
      }
    },
    
    "brands": {
      "HD_PRIORITY": [
        "CATERPILLAR", "CAT", "CUMMINS", "DETROIT", "VOLVO",
        "MACK", "PACCAR", "NAVISTAR", "INTERNATIONAL", "FREIGHTLINER",
        "KOMATSU", "JOHN DEERE", "CASE", "NEW HOLLAND", "DONALDSON",
        "BALDWIN", "FLEETGUARD", "DURAMAX"
      ],
      "LD_PRIORITY": [
        "TOYOTA", "NISSAN", "HONDA", "BMW", "AUDI", "LEXUS",
        "VOLKSWAGEN", "CHEVROLET", "FORD", "KIA", "HYUNDAI", "FRAM",
        "AC DELCO", "MOTORCRAFT", "MOPAR"
      ]
    },
    
    "validation": {
      "min_length": 3,
      "max_length": 10,
      "allow_special_chars": ["-", "_", "."],
      "must_contain": ["number"],
      "normalize_uppercase": true
    },
    
    "delimiters": [",", ";", "\n", " ", "|"],
    "search_order_max": 10,
    
    "search_order": [
      {
        "duty": "HD",
        "priority": "HD_PRIMARY",
        "order": [
          {"source": "cross_reference", "target": "donaldson", "priority": 1},
          {"source": "oem_codes", "target": "donaldson", "priority": 2},
          {"source": "oem_codes", "target": "hd_brands", "priority": 3},
          {"source": "oem_codes", "target": "generic", "priority": 4}
        ]
      },
      {
        "duty": "LD",
        "priority": "LD_PRIMARY",
        "order": [
          {"source": "cross_reference", "target": "fram", "priority": 1},
          {"source": "oem_codes", "target": "fram", "priority": 2},
          {"source": "oem_codes", "target": "ld_brands", "priority": 3},
          {"source": "oem_codes", "target": "generic", "priority": 4}
        ]
      }
    ]
  },

  "prefixes": {
    "ACEITE": "EL8",
    "OIL": "EL8",
    "COMBUSTIBLE": "EF9",
    "FUEL": "EF9",
    "SEPARADOR": "EF9",
    "SEPARATOR": "EF9",
    "AIRE": "EA1",
    "AIR": "EA1",
    "CABIN": "EC1",
    "CABIN AIR": "EC1",
    "AIRE_CABINA": "EC1",
    "HYDRAULIC": "EH6",
    "HIDRAULICO": "EH6",
    "COOLANT": "EW7",
    "REFRIGERANTE": "EW7",
    "AIR DRYER": "ED4",
    "AIR_DRYER": "ED4",
    "KIT_DIESEL": "EK5",
    "KIT DIESEL": "EK5",
    "KIT_GAS": "EK3",
    "KIT PASAJEROS": "EK3",
    "CARCASA": "EC1",
    "HOUSING": "EC1",
    "TURBINA": "ET9",
    "TURBINE": "ET9"
  },

  "rules": {
    "regla_1_sku_generation": {
      "description": "Generar SKU con formato PREFIX-LAST4",
      "steps": [
        "Obtener prefix de family + dutyLevel",
        "Obtener último 4 dígitos de baseCode",
        "Combinar: PREFIX-LAST4"
      ]
    },
    "regla_2_universo_busqueda_cascada": {
      "description": "Buscar baseCode en universo OEM completo",
      "steps": [
        "Normalizar múltiples OEM codes",
        "Ejecutar search_order según duty",
        "Retornar: source_code_used, source_type, matched_pattern"
      ]
    },
    "regla_3_prefix_determination": {
      "description": "Determinar prefix según family",
      "steps": [
        "Buscar family en prefixes map",
        "Si HD/LD especial, aplicar lógica",
        "Fallback a EL8 (Oil)"
      ]
    }
  }
}
